<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½“èª¿ãƒ¢ãƒ‹ã‚¿ãƒ¼ - æç«œè‚²æˆ</title>

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ä½“èª¿ãƒ¢ãƒ‹ã‚¿ãƒ¼">
    <link rel="apple-touch-icon" href="assets/icons/icon-192.png">
    <meta name="description" content="æ¯æ—¥ã®ä½“èª¿ã‚’è¨˜éŒ²ã—ã¦æç«œã‚’è‚²ã¦ã‚ˆã†">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 600px;
            margin: 2rem auto;
            padding: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        h1 {
            color: #667eea;
            text-align: center;
        }

        .emoji-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 2rem 0;
        }

        .emoji-btn {
            background: #f1f5f9;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 2rem;
            min-width: 100px;
            text-align: center;
        }

        .emoji-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            border-color: #667eea;
        }

        .number-buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            margin: 2rem 0;
        }

        .number-btn {
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        .number-btn:hover {
            background: #5568d3;
            transform: scale(1.05);
        }

        .result {
            text-align: center;
            padding: 2rem;
            background: #f0fdf4;
            border-radius: 12px;
            margin-top: 2rem;
            display: none;
        }

        .result.show {
            display: block;
        }

        .result h2 {
            color: #10b981;
            margin: 0 0 1rem 0;
        }

        .history {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #e2e8f0;
        }

        .history-item {
            background: #f8fafc;
            padding: 1rem;
            border-radius: 8px;
            margin: 0.5rem 0;
            display: flex;
            justify-content: space-between;
        }

        .back-btn {
            background: #94a3b8;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 1rem;
        }

        .back-btn:hover {
            background: #64748b;
        }

        .hidden {
            display: none;
        }

        .data-controls {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .export-btn,
        .import-btn {
            flex: 1;
            padding: 0.5rem;
            border-radius: 8px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .export-btn:hover,
        .import-btn:hover {
            background: #f0f4ff;
        }

        #fileInput {
            display: none;
        }

        .character-display {
            text-align: center;
            padding: 2rem 1rem;
            margin: 1rem 0;
            background: linear-gradient(135deg, #f0f4ff 0%, #e8f0fe 100%);
            border-radius: 16px;
        }

        .character-emoji {
            width: 220px;
            height: 220px;
            display: block;
            margin: 0 auto 0.5rem;
            image-rendering: pixelated;
            object-fit: contain;
            animation: bounce 2s ease-in-out infinite;
            transition: transform 0.3s ease;
        }

        .character-emoji.growing {
            animation: grow 1s ease-in-out;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes grow {
            0% {
                transform: scale(1) rotate(0deg);
            }

            25% {
                transform: scale(1.5) rotate(-10deg);
            }

            50% {
                transform: scale(1.2) rotate(10deg);
            }

            75% {
                transform: scale(1.5) rotate(-10deg);
            }

            100% {
                transform: scale(1) rotate(0deg);
            }
        }

        .character-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 0.25rem;
        }

        .character-stats {
            font-size: 0.9rem;
            color: #64748b;
        }

        .next-stage {
            font-size: 0.85rem;
            color: #10b981;
            margin-top: 0.5rem;
        }

        .selection-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .selection-modal.show {
            display: flex;
        }

        .selection-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            text-align: center;
        }

        .selection-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 1rem;
        }

        .dino-options {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
            /* æŠ˜ã‚Šè¿”ã— */
            justify-content: center;
            /* ä¸­å¤®å¯„ã› */
            max-height: 50vh;
            /* ç”»é¢ã®åŠåˆ†ç¨‹åº¦ã®é«˜ã•ã«åˆ¶é™ */
            overflow-y: auto;
            /* ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ‰åŠ¹åŒ– */
            padding: 10px;
            /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã¨ã®ä½™ç™½ */
        }

        .dino-card {
            flex: 1;
            padding: 1.5rem;
            border: 3px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .dino-card:hover {
            border-color: #667eea;
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .dino-card img {
            width: 100px;
            height: 100px;
            image-rendering: pixelated;
            object-fit: contain;
            margin-bottom: 0.5rem;
        }

        .dino-name {
            font-weight: 600;
            color: #1e293b;
        }

        .memo-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
            min-height: 80px;
        }

        .memo-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn-group {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .btn-primary {
            flex: 1;
            background: #667eea;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-secondary {
            flex: 1;
            background: #e2e8f0;
            color: #64748b;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
        }

        .btn-secondary:hover {
            background: #cbd5e1;
        }

        .settings-btn {
            background: #e2e8f0;
            color: #64748b;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            margin-left: 0.5rem;
            font-size: 1.2rem;
        }

        .settings-btn:hover {
            background: #cbd5e1;
        }

        .backup-area {
            background: #f8fafc;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            text-align: left;
        }

        .backup-desc {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 0.5rem;
        }

        .backup-textarea {
            width: 100%;
            height: 100px;
            padding: 0.5rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.8rem;
            resize: vertical;
            margin-bottom: 0.5rem;
        }

        .copy-btn {
            background: #3b82f6;
            color: white;
            width: 100%;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .restore-btn {
            background: #ef4444;
            color: white;
            width: 100%;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="container">
            <header class="app-header">
                <h1 style="margin: 0; font-size: 1.5rem;">ğŸ¦• ä½“èª¿ãƒ¢ãƒ‹ã‚¿ãƒ¼</h1>
                <div class="header-buttons">
                    <a href="history-calendar.html" class="icon-link" aria-label="ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼">ğŸ“…</a>
                    <a href="encyclopedia.html" class="icon-link" aria-label="å›³é‘‘">ğŸ“š</a>
                    <button class="settings-btn" onclick="openSettings()" aria-label="è¨­å®š">âš™ï¸</button>
                </div>
            </header>

            <style>
                .app-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 2rem;
                }

                .header-buttons {
                    display: flex;
                    gap: 0.5rem;
                }

                .icon-link {
                    background: #f1f5f9;
                    color: #1e293b;
                    width: 44px;
                    height: 44px;
                    border-radius: 12px;
                    text-decoration: none;
                    font-size: 1.5rem;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    border: 2px solid #e2e8f0;
                    transition: transform 0.1s;
                }

                .icon-link:active {
                    transform: scale(0.95);
                }

                .settings-btn {
                    background: #f1f5f9;
                    color: #1e293b;
                    width: 44px;
                    height: 44px;
                    padding: 0;
                    border: 2px solid #e2e8f0;
                    border-radius: 12px;
                    font-size: 1.5rem;
                    margin-left: 0;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                /* ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ«ä¿®æ­£ */
                .selection-content {
                    width: 90% !important;
                    max-width: 400px !important;
                    padding: 1.5rem !important;
                    max-height: 85vh;
                    overflow-y: auto;
                }

                /* ã‚¹ãƒãƒ›ç”¨èª¿æ•´ */
                @media (max-width: 480px) {
                    .container {
                        padding: 1rem;
                    }

                    .app-header {
                        flex-direction: row;
                        /* æ¨ªä¸¦ã³ç¶­æŒï¼ˆã‚¢ã‚¤ã‚³ãƒ³åŒ–ã—ãŸã®ã§åã¾ã‚‹ã¯ãšï¼‰ */
                        margin-bottom: 1.5rem;
                    }

                    h1 {
                        font-size: 1.2rem !important;
                    }
                }
            </style>

            <!-- ã‚¹ãƒ†ãƒƒãƒ—1 -->
            <div id="step1">
                <p style="text-align: center; color: #64748b;">ä»Šæ—¥ã®ä½“èª¿ã¯ã©ã†ã§ã™ã‹ï¼Ÿ</p>
                <div class="emoji-buttons">
                    <button class="emoji-btn" onclick="selectRange('good')">
                        <div>ğŸ˜Š</div>
                        <div style="font-size: 0.9rem; margin-top: 0.5rem;">è‰¯ã„</div>
                    </button>
                    <button class="emoji-btn" onclick="selectRange('normal')">
                        <div>ğŸ˜</div>
                        <div style="font-size: 0.9rem; margin-top: 0.5rem;">æ™®é€š</div>
                    </button>
                    <button class="emoji-btn" onclick="selectRange('bad')">
                        <div>ğŸ˜</div>
                        <div style="font-size: 0.9rem; margin-top: 0.5rem;">æ‚ªã„</div>
                    </button>
                </div>
            </div>

            <!-- ã‚¹ãƒ†ãƒƒãƒ—2 -->
            <div id="step2" class="hidden">
                <button class="back-btn" onclick="goBack()">â† æˆ»ã‚‹</button>
                <p style="text-align: center; color: #64748b;">å…·ä½“çš„ã«ã¯ï¼Ÿ</p>
                <div class="number-buttons" id="numberButtons"></div>
            </div>

            <!-- ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ¡ãƒ¢å…¥åŠ› -->
            <div id="step3" class="hidden">
                <button class="back-btn" onclick="goBackToStep2()">â† æˆ»ã‚‹</button>
                <p style="text-align: center; color: #64748b; margin-bottom: 1rem;">ä¸€è¨€ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰</p>
                <textarea id="memoInput" class="memo-input" placeholder="ä»Šæ—¥ã®ä½“èª¿ã«ã¤ã„ã¦ä¸€è¨€...ï¼ˆä¾‹: ã‚ˆãçœ ã‚ŒãŸã€é ­ç—›ãŒã™ã‚‹ã€ãªã©ï¼‰"
                    maxlength="100"></textarea>
                <div class="btn-group">
                    <button class="btn-secondary" onclick="skipMemo()">ã‚¹ã‚­ãƒƒãƒ—</button>
                    <button class="btn-primary" onclick="saveMemo()">è¨˜éŒ²ã™ã‚‹</button>
                </div>
            </div>

            <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨ç¤º -->
            <div class="character-display" id="characterDisplay">
                <img src="assets/characters/trex_egg.png" alt="ã‚¿ãƒã‚´" class="character-emoji" id="characterEmoji">
                <div class="character-name" id="characterName">ã‚¿ãƒã‚´</div>
                <div class="character-stats" id="characterStats">é€£ç¶šè¨˜éŒ²: 0æ—¥</div>
                <div class="next-stage" id="nextStage">è¨˜éŒ²ã™ã‚‹ã¨å­µåŒ–ã—ã¾ã™ï¼</div>
            </div>

            <!-- çµæœ -->
            <div id="result" class="result">
                <h2>âœ… è¨˜éŒ²å®Œäº†ï¼</h2>
                <p>ä½“èª¿å€¤: <span id="recordedValue">-</span></p>
                <p id="encouragement">ç´ æ™´ã‚‰ã—ã„ï¼</p>
            </div>

            <!-- å±¥æ­´ -->
            <div class="history">
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem;">
                    <h3>ğŸ“Š æœ€è¿‘ã®è¨˜éŒ² (<span id="recordCount">0</span>ä»¶)</h3>
                    <div style="display: flex; gap: 0.5rem;">
                        <a href="encyclopedia.html"
                            style="background: #f59e0b; color: white; padding: 0.5rem 1rem; border-radius: 8px; text-decoration: none; font-size: 0.9rem;">ğŸ“š
                            å›³é‘‘</a>
                        <a href="graph.html"
                            style="background: #10b981; color: white; padding: 0.5rem 1rem; border-radius: 8px; text-decoration: none; font-size: 0.9rem;">ğŸ“ˆ
                            ã‚°ãƒ©ãƒ•è¡¨ç¤º</a>
                        <a href="history-calendar.html"
                            style="background: #667eea; color: white; padding: 0.5rem 1rem; border-radius: 8px; text-decoration: none; font-size: 0.9rem;">ğŸ“…
                            ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º</a>
                    </div>
                </div>
                <div class="data-controls">
                    <button class="export-btn" onclick="exportData()">â¬‡ï¸ ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                    <button class="import-btn" onclick="document.getElementById('fileInput').click()">â¬†ï¸
                        ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
                    <input type="file" id="fileInput" accept=".json" onchange="importData(event)">
                </div>
                <div id="historyList"></div>
            </div>
        </div>

        <!-- æç«œé¸æŠãƒ¢ãƒ¼ãƒ€ãƒ« -->
        <div class="selection-modal" id="selectionModal">
            <div class="selection-content">
                <h2 class="selection-title">ğŸ¦– ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚’é¸ã¶</h2>
                <p style="color: #64748b;">ä¸€ç·’ã«æˆé•·ã™ã‚‹æç«œã‚’é¸ã‚“ã§ãã ã•ã„</p>
                <div class="dino-options">
                    <div class="dino-card" onclick="selectDinosaur('trex')">
                        <img src="assets/characters/trex_egg.png" alt="T-Rex">
                        <div class="dino-name">ãƒ†ã‚£ãƒ©ãƒã‚µã‚¦ãƒ«ã‚¹</div>
                    </div>
                    <div class="dino-card" onclick="selectDinosaur('pteranodon')">
                        <img src="assets/characters/pteranodon_egg.png" alt="Pteranodon">
                        <div class="dino-name">ãƒ—ãƒ†ãƒ©ãƒãƒ‰ãƒ³</div>
                    </div>
                    <div class="dino-card" onclick="selectDinosaur('triceratops')">
                        <img src="assets/characters/triceratops_egg.png" alt="Triceratops">
                        <div class="dino-name">ãƒˆãƒªã‚±ãƒ©ãƒˆãƒ—ã‚¹</div>
                    </div>
                    <div class="dino-card" onclick="selectDinosaur('stegosaurus')">
                        <img src="assets/characters/stegosaurus_egg.png" alt="Stegosaurus">
                        <div class="dino-name">ã‚¹ãƒ†ã‚´ã‚µã‚¦ãƒ«ã‚¹</div>
                    </div>
                    <div class="dino-card" onclick="selectDinosaur('spinosaurus')">
                        <img src="assets/characters/spinosaurus_egg.png" alt="Spinosaurus">
                        <div class="dino-name">ã‚¹ãƒ”ãƒã‚µã‚¦ãƒ«ã‚¹</div>
                    </div>
                    <div class="dino-card" onclick="selectDinosaur('styracosaurus')">
                        <img src="assets/characters/styracosaurus_egg.png" alt="Styracosaurus">
                        <div class="dino-name">ã‚¹ãƒ†ã‚£ãƒ©ã‚³ã‚µã‚¦ãƒ«ã‚¹</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ« -->
        <div class="selection-modal" id="settingsModal">
            <div class="selection-content">
                <h2 class="selection-title">âš™ï¸ è¨­å®šãƒ»ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h2>
                <div class="backup-area">
                    <p class="backup-desc">
                        ç¾åœ¨ã®ã‚¢ãƒ—ãƒªãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«è¡¨ç¤ºã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼ã—ã€å®‰å…¨ãªå ´æ‰€ã«ä¿å­˜ã—ã¦ãã ã•ã„ã€‚
                    </p>
                    <textarea id="exportText" class="backup-textarea" readonly></textarea>
                    <button class="copy-btn" onclick="exportBackup()">ã‚³ãƒ”ãƒ¼ã—ã¦ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</button>
                </div>
                <div class="backup-area">
                    <p class="backup-desc">
                        ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã§ãã¾ã™ã€‚ä¿å­˜ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä»¥ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚
                    </p>
                    <textarea id="importText" class="backup-textarea" placeholder="ã“ã“ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„"></textarea>
                    <button class="restore-btn" onclick="importBackup()">ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ</button>
                </div>
                <button class="restore-btn" onclick="importBackup()">ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ</button>
            </div>

            <div class="backup-area">
                <p class="backup-desc" style="font-weight: 600; color: #1e293b;">ğŸ”” é€šçŸ¥ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼</p>
                <p class="backup-desc">
                    æ¯æœ 7:30 ã«è¨˜éŒ²å¿˜ã‚Œé˜²æ­¢ã®é€šçŸ¥ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚<br>
                    â€»ã‚¢ãƒ—ãƒªã‚’å®Œå…¨ã«çµ‚äº†ã•ã›ã¦ã„ã‚‹ã¨é€šçŸ¥ã•ã‚Œãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
                </p>
                <button id="notifyBtn" class="copy-btn" style="background: #8b5cf6;"
                    onclick="toggleNotification()">é€šçŸ¥è¨­å®šã‚’ONã«ã™ã‚‹</button>
            </div>

            <button class="btn-secondary" onclick="closeSettings()">é–‰ã˜ã‚‹</button>
        </div>
    </div>

    <script>
        // ãƒ‡ãƒ¼ã‚¿ä¿å­˜ç”¨
        let records = JSON.parse(localStorage.getItem('simpleHealthRecords') || '[]');
        let growthData = JSON.parse(localStorage.getItem('growthData') || null);

        // æç«œãƒ‡ãƒ¼ã‚¿å®šç¾©
        // æç«œãƒ‡ãƒ¼ã‚¿å®šç¾©
        const dinosaurs = {
            trex: {
                name: 'ãƒ†ã‚£ãƒ©ãƒã‚µã‚¦ãƒ«ã‚¹',
                scale: 1.2,
                stages: {
                    0: { image: 'trex_egg.png', name: 'ã‚¿ãƒã‚´' },
                    1: { image: 'trex_baby.png', name: 'èµ¤ã¡ã‚ƒã‚“ãƒ†ã‚£ãƒ©ãƒ' },
                    2: { image: 'trex_child.png', name: 'å­ä¾›ãƒ†ã‚£ãƒ©ãƒ' },
                    3: { image: 'trex_adult.png', name: 'å¤§äººãƒ†ã‚£ãƒ©ãƒ' }
                }
            },
            pteranodon: {
                name: 'ãƒ—ãƒ†ãƒ©ãƒãƒ‰ãƒ³',
                scale: 1.2,
                stages: {
                    0: { image: 'pteranodon_egg.png', name: 'ã‚¿ãƒã‚´' },
                    1: { image: 'pteranodon_baby.png', name: 'èµ¤ã¡ã‚ƒã‚“ãƒ—ãƒ†ãƒ©ãƒãƒ‰ãƒ³' },
                    2: { image: 'pteranodon_child.png', name: 'å­ä¾›ãƒ—ãƒ†ãƒ©ãƒãƒ‰ãƒ³' },
                    3: { image: 'pteranodon_adult.png', name: 'å¤§äººãƒ—ãƒ†ãƒ©ãƒãƒ‰ãƒ³' }
                }
            },
            triceratops: {
                name: 'ãƒˆãƒªã‚±ãƒ©ãƒˆãƒ—ã‚¹',
                scale: 1.2,
                stages: {
                    0: { image: 'triceratops_egg.png', name: 'ã‚¿ãƒã‚´' },
                    1: { image: 'triceratops_baby.png', name: 'èµ¤ã¡ã‚ƒã‚“ãƒˆãƒªã‚±ãƒ©' },
                    2: { image: 'triceratops_child.png', name: 'å­ä¾›ãƒˆãƒªã‚±ãƒ©' },
                    3: { image: 'triceratops_adult.png', name: 'å¤§äººãƒˆãƒªã‚±ãƒ©' }
                }
            },
            stegosaurus: {
                name: 'ã‚¹ãƒ†ã‚´ã‚µã‚¦ãƒ«ã‚¹',
                scale: 1.2,
                stages: {
                    0: { image: 'stegosaurus_egg.png', name: 'ã‚¿ãƒã‚´' },
                    1: { image: 'stegosaurus_baby.png', name: 'èµ¤ã¡ã‚ƒã‚“ã‚¹ãƒ†ã‚´' },
                    2: { image: 'stegosaurus_child.png', name: 'å­ä¾›ã‚¹ãƒ†ã‚´' },
                    3: { image: 'stegosaurus_adult.png', name: 'å¤§äººã‚¹ãƒ†ã‚´' }
                }
            },
            spinosaurus: {
                name: 'ã‚¹ãƒ”ãƒã‚µã‚¦ãƒ«ã‚¹',
                scale: 1.2,
                stages: {
                    0: { image: 'spinosaurus_egg.png', name: 'ã‚¿ãƒã‚´' },
                    1: { image: 'spinosaurus_baby.png', name: 'èµ¤ã¡ã‚ƒã‚“ã‚¹ãƒ”ãƒ' },
                    2: { image: 'spinosaurus_child.png', name: 'å­ä¾›ã‚¹ãƒ”ãƒ' },
                    3: { image: 'spinosaurus_adult.png', name: 'å¤§äººã‚¹ãƒ”ãƒ' }
                }
            },
            styracosaurus: {
                name: 'ã‚¹ãƒ†ã‚£ãƒ©ã‚³ã‚µã‚¦ãƒ«ã‚¹',
                scale: 1.2,
                stages: {
                    0: { image: 'styracosaurus_egg.png', name: 'ã‚¿ãƒã‚´' },
                    1: { image: 'styracosaurus_baby.png', name: 'èµ¤ã¡ã‚ƒã‚“ã‚¹ãƒ†ã‚£ãƒ©ã‚³' },
                    2: { image: 'styracosaurus_child.png', name: 'å­ä¾›ã‚¹ãƒ†ã‚£ãƒ©ã‚³' },
                    3: { image: 'styracosaurus_adult.png', name: 'å¤§äººã‚¹ãƒ†ã‚£ãƒ©ã‚³' }
                }
            }
        };

        // æˆé•·ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸåŒ–
        if (!growthData) {
            growthData = {
                selectedDinosaur: null,
                consecutiveDays: 0,
                lastRecordDate: null,
                currentStage: 0
            };
            localStorage.setItem('growthData', JSON.stringify(growthData));
        }

        // ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„å ´åˆã€é¸æŠãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
        window.addEventListener('load', () => {
            checkMonthlyReset();

            if (!growthData.selectedDinosaur) {
                document.getElementById('selectionModal').classList.add('show');
            } else {
                updateCharacterDisplay();
            }
        });

        // æˆé•·æ®µéšå–å¾—
        function getStage(days) {
            const dino = dinosaurs[growthData.selectedDinosaur];
            let stageLevel = 0;
            let next = 1;

            if (days >= 22) { stageLevel = 3; next = null; }
            else if (days >= 8) { stageLevel = 2; next = 22 - days; }
            else if (days >= 1) { stageLevel = 1; next = 8 - days; }

            return {
                stage: stageLevel,
                image: `assets/characters/${dino.stages[stageLevel].image}`,
                name: dino.stages[stageLevel].name,
                next: next
            };
        }

        // ä»®æƒ³æ—¥ä»˜å–å¾—ï¼ˆAM4:00åˆ‡ã‚Šæ›¿ãˆï¼‰
        function getVirtualDate() {
            const now = new Date();
            now.setHours(now.getHours() - 4);
            return now;
        }

        // æœˆæ¬¡ãƒªã‚»ãƒƒãƒˆãƒã‚§ãƒƒã‚¯
        function checkMonthlyReset() {
            const currentMonth = getVirtualDate().toISOString().slice(0, 7); // "YYYY-MM"

            if (growthData && growthData.selectionMonth && growthData.selectionMonth !== currentMonth) {
                // æœˆãŒå¤‰ã‚ã£ãŸå ´åˆã®ãƒªã‚»ãƒƒãƒˆå‡¦ç†
                alert('æ–°ã—ã„æœˆã«ãªã‚Šã¾ã—ãŸï¼\nä»Šæœˆã®ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚');

                // å›³é‘‘ã«ç¾åœ¨ã®çŠ¶æ…‹ã‚’å¼·åˆ¶ä¿å­˜ï¼ˆå¿µã®ãŸã‚ï¼‰
                const currentStage = getStage(growthData.consecutiveDays).stage;
                updateEncyclopedia(growthData.selectedDinosaur, currentStage);

                // ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆï¼ˆå›³é‘‘ä»¥å¤–ï¼‰
                growthData.selectedDinosaur = null;
                growthData.consecutiveDays = 0;
                growthData.lastRecordDate = null;
                growthData.selectionMonth = currentMonth;
                localStorage.setItem('growthData', JSON.stringify(growthData));
            }
        }

        // æç«œé¸æŠ
        function selectDinosaur(type) {
            if (!growthData) {
                growthData = {
                    consecutiveDays: 0,
                    lastRecordDate: null,
                    selectionMonth: new Date().toISOString().slice(0, 7)
                };
            }
            growthData.selectedDinosaur = type;
            growthData.selectedDinosaur = type;
            growthData.selectionMonth = getVirtualDate().toISOString().slice(0, 7); // ç¾åœ¨ã®æœˆã‚’è¨˜éŒ²
            localStorage.setItem('growthData', JSON.stringify(growthData));

            document.getElementById('selectionModal').classList.remove('show');
            updateCharacterDisplay();
        }

        // å›³é‘‘æ›´æ–°
        function updateEncyclopedia(dinosaur, stage) {
            let encyclopedia = JSON.parse(localStorage.getItem('encyclopedia') || '{}');

            if (!encyclopedia[dinosaur] || encyclopedia[dinosaur].maxStage < stage) {
                encyclopedia[dinosaur] = {
                    maxStage: stage,
                    completedDate: getVirtualDate().toISOString().split('T')[0]
                };
                localStorage.setItem('encyclopedia', JSON.stringify(encyclopedia));
            }
        }

        // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨ç¤ºæ›´æ–°
        function updateCharacterDisplay(isGrowing = false) {
            const stageInfo = getStage(growthData.selectedDinosaur ? growthData.consecutiveDays : 0); // selectedDinosaurãŒnullã®å ´åˆã¯0æ—¥ã¨ã—ã¦æ‰±ã†
            const img = document.getElementById('characterEmoji');

            if (isGrowing) {
                img.classList.add('growing');
                setTimeout(() => img.classList.remove('growing'), 1000);
            }

            img.src = stageInfo.image;
            img.alt = stageInfo.name;
            document.getElementById('characterName').textContent = stageInfo.name;

            // ã‚¹ã‚±ãƒ¼ãƒ«é©ç”¨
            const dino = dinosaurs[growthData.selectedDinosaur];
            if (dino && dino.scale) {
                img.style.transform = `scale(${dino.scale})`;
            } else {
                img.style.transform = 'scale(1)';
            }

            document.getElementById('characterStats').textContent = `é€£ç¶šè¨˜éŒ²: ${growthData.consecutiveDays}æ—¥`;

            if (stageInfo.next !== null) {
                document.getElementById('nextStage').textContent =
                    stageInfo.next === 1 ? 'è¨˜éŒ²ã™ã‚‹ã¨å­µåŒ–ã—ã¾ã™ï¼' : `ã‚ã¨${stageInfo.next}æ—¥ã§æˆé•·ï¼`;
            } else {
                document.getElementById('nextStage').textContent = 'æœ€å¤§ãƒ¬ãƒ™ãƒ«é”æˆï¼';
            }
        }

        function selectRange(range) {
            const numbers = range === 'good' ? [8, 9, 10] :
                range === 'normal' ? [4, 5, 6, 7] : [1, 2, 3];

            const container = document.getElementById('numberButtons');
            container.innerHTML = '';

            numbers.forEach(num => {
                const btn = document.createElement('button');
                btn.className = 'number-btn';
                btn.textContent = num;
                btn.onclick = () => showMemoStep(num);
                container.appendChild(btn);
            });

            document.getElementById('step1').classList.add('hidden');
            document.getElementById('step2').classList.remove('hidden');
        }

        let selectedValue = null;

        function showMemoStep(value) {
            selectedValue = value;
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step3').classList.remove('hidden');
            document.getElementById('memoInput').value = '';
            document.getElementById('memoInput').focus();
        }

        function goBackToStep2() {
            document.getElementById('step3').classList.add('hidden');
            document.getElementById('step2').classList.remove('hidden');
        }

        function skipMemo() {
            recordValue(selectedValue, '');
        }

        function saveMemo() {
            const memo = document.getElementById('memoInput').value.trim();
            recordValue(selectedValue, memo);
        }

        function goBack() {
            document.getElementById('step1').classList.remove('hidden');
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('result').classList.remove('show');
        }

        function recordValue(value, memo = '') {
            const today = getVirtualDate().toISOString().split('T')[0];
            const time = new Date().toLocaleTimeString('ja-JP');

            // æ—¢å­˜ã®åŒæ—¥è¨˜éŒ²ã‚’æ¢ã™
            const existingIndex = records.findIndex(r => r.date === today);

            const record = {
                date: today,
                time: time,
                value: value,
                memo: memo,
                timestamp: Date.now()
            };

            // æˆé•·ã‚·ã‚¹ãƒ†ãƒ ç”¨å¤‰æ•°
            const isNewRecord = existingIndex === -1;
            let didGrow = false;

            if (existingIndex !== -1) {
                // æ—¢å­˜ã®è¨˜éŒ²ã‚’æ›´æ–°
                records[existingIndex] = record;
            } else {
                // æ–°è¦è¿½åŠ 
                records.push(record);
            }

            localStorage.setItem('simpleHealthRecords', JSON.stringify(records));

            let encouragementMsg = value >= 8 ? 'ç´ æ™´ã‚‰ã—ã„èª¿å­ã§ã™ï¼' :
                value >= 4 ? 'å®‰å®šã—ã¦ã„ã¾ã™ã­ã€‚' : 'ç„¡ç†ã›ãšä¼‘ã‚“ã§ãã ã•ã„ã€‚';

            // æˆé•·ã—ãŸå ´åˆã¯ç‰¹åˆ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            if (isNewRecord) {
                const oldStage = getStage(growthData.consecutiveDays).stage; // ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã‚’ä¿å­˜
                growthData.lastRecordDate = today;
                growthData.consecutiveDays++;
                const newStage = getStage(growthData.consecutiveDays).stage;
                didGrow = newStage > oldStage;

                // å›³é‘‘æ›´æ–°ï¼ˆæˆé•·æ™‚ï¼‰
                if (didGrow) {
                    updateEncyclopedia(growthData.selectedDinosaur, newStage);
                }
                localStorage.setItem('growthData', JSON.stringify(growthData));

                // è¡¨ç¤ºã‚’å³æ™‚æ›´æ–°
                updateCharacterDisplay(didGrow);
            }

            if (isNewRecord && didGrow) {
                const stageInfo = getStage(growthData.consecutiveDays);
                encouragementMsg = `ğŸ‰ ãŠã‚ã§ã¨ã†ï¼${stageInfo.name}ã«æˆé•·ã—ã¾ã—ãŸï¼`;
            }

            document.getElementById('recordedValue').textContent = value;
            document.getElementById('encouragement').textContent = encouragementMsg;

            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step3').classList.add('hidden');
            document.getElementById('result').classList.add('show');

            updateHistory();
        }

        function updateHistory() {
            const historyList = document.getElementById('historyList');
            const sorted = [...records].reverse().slice(0, 10);

            document.getElementById('recordCount').textContent = records.length;

            if (sorted.length === 0) {
                historyList.innerHTML = '<p style="text-align: center; color: #94a3b8;">ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</p>';
                return;
            }

            historyList.innerHTML = sorted.map(r => `
                <div class="history-item">
                    <span>${r.date} ${r.time}</span>
                    <strong style="color: #667eea;">ä½“èª¿å€¤: ${r.value}</strong>
                </div>
            `).join('');
        }

        // åˆæœŸåŒ–
        updateHistory();
        updateCharacterDisplay();
        checkTodayRecord();

        function checkTodayRecord() {
            const today = new Date().toISOString().split('T')[0];
            const todayRecord = records.find(r => r.date === today);

            if (todayRecord) {
                document.getElementById('step1').classList.add('hidden');
                document.getElementById('recordedValue').textContent = todayRecord.value;
                document.getElementById('encouragement').innerHTML =
                    `ä»Šæ—¥ã¯æ—¢ã«è¨˜éŒ²æ¸ˆã¿ã§ã™ã€‚<br><small style="color: #64748b;">ç·¨é›†ã™ã‚‹å ´åˆã¯<a href="history-calendar.html" style="color: #667eea;">ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</a>ã‹ã‚‰å¤‰æ›´ã§ãã¾ã™ã€‚</small>`;
                document.getElementById('result').classList.add('show');
            }
        }

        function exportData() {
            const dataStr = JSON.stringify(records, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `health-records-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedRecords = JSON.parse(e.target.result);
                    if (confirm(`${importedRecords.length}ä»¶ã®è¨˜éŒ²ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚\nç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ`)) {
                        records = importedRecords;
                        localStorage.setItem('simpleHealthRecords', JSON.stringify(records));
                        updateHistory();
                        checkTodayRecord();
                        alert('ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Œäº†ï¼');
                        location.reload();
                    }
                } catch (error) {
                    alert('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«ãŒç ´æã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚');
                }
            };
            reader.readAsText(file);
        }
        // è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«
        function openSettings() {
            document.getElementById('settingsModal').style.display = 'flex';

            // é–‹ã„ãŸæ™‚ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•ç”Ÿæˆ
            const data = {
                version: 1,
                timestamp: Date.now(),
                simpleHealthRecords: JSON.parse(localStorage.getItem('simpleHealthRecords') || '[]'),
                growthData: JSON.parse(localStorage.getItem('growthData') || '{}'),
                encyclopedia: JSON.parse(localStorage.getItem('encyclopedia') || '{}')
            };
            document.getElementById('exportText').value = JSON.stringify(data);
        }

        function closeSettings() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        function exportBackup() {
            const text = document.getElementById('exportText');
            text.select();
            document.execCommand('copy');

            // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰APIã‚‚è©¦è¡Œ
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text.value).then(() => {
                    alert('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\nãƒ¡ãƒ¢å¸³ãªã©ã«è²¼ã‚Šä»˜ã‘ã¦ä¿å­˜ã—ã¦ãã ã•ã„ã€‚');
                }).catch(() => {
                    alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼ˆãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã‚’é¸æŠæ¸ˆã¿ï¼‰');
                });
            } else {
                alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼ˆãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã‚’é¸æŠæ¸ˆã¿ï¼‰');
            }
        }

        function importBackup() {
            const text = document.getElementById('importText').value.trim();
            if (!text) {
                alert('ãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„');
                return;
            }

            try {
                const data = JSON.parse(text);

                // ç°¡æ˜“ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
                if (!data.simpleHealthRecords || !data.growthData) {
                    throw new Error('ãƒ‡ãƒ¼ã‚¿ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“');
                }

                if (!confirm('ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã¯å…¨ã¦ä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚\næœ¬å½“ã«å¾©å…ƒã—ã¾ã™ã‹ï¼Ÿ')) {
                    return;
                }

                localStorage.setItem('simpleHealthRecords', JSON.stringify(data.simpleHealthRecords));
                localStorage.setItem('growthData', JSON.stringify(data.growthData));
                if (data.encyclopedia) {
                    localStorage.setItem('encyclopedia', JSON.stringify(data.encyclopedia));
                }

                alert('ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã—ã¾ã—ãŸï¼\nã‚¢ãƒ—ãƒªã‚’å†èµ·å‹•ã—ã¾ã™ã€‚');
                location.reload();

            } catch (e) {
                alert('ã‚¨ãƒ©ãƒ¼ï¼šãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãèª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚\n' + e.message);
            }
        }

        // é€šçŸ¥æ©Ÿèƒ½
        function initNotification() {
            updateNotifyButton();
            checkAndNotify();

            // æ¯åˆ†ãƒã‚§ãƒƒã‚¯ï¼ˆã‚¢ãƒ—ãƒªèµ·å‹•ä¸­ï¼‰
            setInterval(() => {
                const now = new Date();
                if (now.getHours() === 7 && now.getMinutes() === 30) {
                    checkAndNotify();
                }
            }, 60000);
        }

        function updateNotifyButton() {
            const btn = document.getElementById('notifyBtn');
            if (Notification.permission === 'granted') {
                btn.textContent = 'é€šçŸ¥ã¯ONã§ã™ âœ…';
                btn.style.background = '#10b981';
            } else if (Notification.permission === 'denied') {
                btn.textContent = 'é€šçŸ¥ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™ ğŸš«';
                btn.style.background = '#ef4444';
            } else {
                btn.textContent = 'é€šçŸ¥è¨­å®šã‚’ONã«ã™ã‚‹ ğŸ””';
                btn.style.background = '#8b5cf6';
            }
        }

        function toggleNotification() {
            if (Notification.permission === 'granted') {
                alert('é€šçŸ¥ã¯æ—¢ã«æœ‰åŠ¹ã§ã™ã€‚');
                return;
            }

            Notification.requestPermission().then(permission => {
                updateNotifyButton();
                if (permission === 'granted') {
                    new Notification('é€šçŸ¥ãŒONã«ãªã‚Šã¾ã—ãŸ', {
                        body: 'æ¯æœ7:30ã«ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’ãŠå±Šã‘ã—ã¾ã™ï¼ˆã‚¢ãƒ—ãƒªã‚’é–‹ã„ã¦ãŠãã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ï¼‰',
                        icon: 'assets/icons/icon-192.png'
                    });
                }
            });
        }

        function checkAndNotify() {
            if (Notification.permission !== 'granted') return;

            const now = new Date();
            const todayStr = getVirtualDate().toISOString().split('T')[0];

            // ä»Šæ—¥ã®è¨˜éŒ²ãŒã‚ã‚‹ã‹ç¢ºèª
            const hasRecord = records.some(r => r.date === todayStr);

            // 7:30ä»¥é™ã§ã€ã¾ã è¨˜éŒ²ãŒãªã„å ´åˆ
            if (!hasRecord) {
                // ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã®ãƒã‚§ãƒƒã‚¯ï¼ˆ7:30éãã¦ã„ã‚‹å ´åˆï¼‰
                if (now.getHours() > 7 || (now.getHours() === 7 && now.getMinutes() >= 30)) {
                    // æ—¢ã«ä»Šæ—¥é€šçŸ¥æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹ã®ãŒãƒ™ã‚¹ãƒˆã ãŒã€
                    // ç°¡æ˜“çš„ã«ã€Œèµ·å‹•æ™‚ã«1å›å‡ºã™ã€ã“ã¨ã«ã™ã‚‹ï¼ˆã“ã“ã‚’èª¿æ•´å¯èƒ½ï¼‰

                    // ä»Šå›ã¯ã‚·ãƒ³ãƒ—ãƒ«ã«é€šçŸ¥ç™ºè¡Œ
                    new Notification('ä½“èª¿è¨˜éŒ²ã®æ™‚é–“ã§ã™', {
                        body: 'ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ä»Šæ—¥ã®ä½“èª¿ã‚’è¨˜éŒ²ã—ã¦ã€æç«œã‚’è‚²ã¦ã¾ã—ã‚‡ã†ğŸ¦•',
                        icon: 'assets/icons/icon-192.png',
                        tag: 'health-reminder-' + todayStr // åŒã˜æ—¥ã®é‡è¤‡é€šçŸ¥ã‚’é˜²ãã‚¿ã‚°
                    });
                }
            }
        }

        // èµ·å‹•æ™‚ã«é€šçŸ¥åˆæœŸåŒ–
        initNotification();
    </script>
</body>

</html>